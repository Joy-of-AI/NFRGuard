# ğŸ›¡ï¸ NFRGuard AI Agents - Your Banking Security Team

Welcome to NFRGuard - your AI-powered security team that protects Bank of Anthos 24/7. This is a complete system of 7 specialized AI agents that work together to prevent fraud, ensure compliance, and keep customers happy.

## ğŸ“š **Documentation Guide**

### ğŸ—ï¸ **[Architecture Overview](01-Architecture-Overview.md)**
**Start here if you want to understand:**
- What NFRGuard is and how it works
- What each of the 7 AI agents does
- How agents work together to protect your bank
- Real-world examples of fraud prevention

### ğŸ“Š **[Monitoring & Observability](02-Monitoring-Observability.md)**
**Read this to learn:**
- How to monitor your AI agents' performance
- What metrics to watch and why
- How to set up alerts when things go wrong
- Simple ways to see if your system is healthy

### ğŸ¬ **[Demo & Presentation](03-Demo-Presentation.md)**
**Use this for:**
- Creating compelling demos for stakeholders
- Step-by-step demo scripts
- Tips for presenting to business and technical audiences
- Recording and sharing your AI agents in action

### ğŸš€ **[Deployment & Operations](04-Deployment-Operations.md)**
**Follow this to:**
- Deploy Bank of Anthos with AI agents to Google Cloud
- Keep your system running smoothly
- Troubleshoot common problems
- Scale and manage your infrastructure

### ğŸ§  **[RAG System](RAG/README.md)**
**Learn about:**
- Retrieval-Augmented Generation with Australian banking regulations
- How agents access real regulatory documents
- Vertex AI Vector Search integration
- Regulatory compliance and transparency

### ğŸ”§ **[Technical Implementation](05-Technical-Implementation.md)**
**Dive deep into:**
- How each agent is actually implemented
- How agents communicate with each other
- How to extend and modify the system
- Code examples and technical details

### ğŸ“‹ **[Project Summary](PROJECT_SUMMARY.md)**
**Complete project overview:**
- Hosted project URL and live demo
- Comprehensive feature description
- Technologies used and data sources
- Key findings and learnings
- Architecture diagrams and technical details

### ğŸ—ï¸ **[Architecture Diagram](ARCHITECTURE_DIAGRAM.md)**
**Visual system architecture:**
- Technology stack and interactions
- AI agent communication flow
- Data flow and processing
- Deployment architecture

## ğŸ¯ **Quick Start - Choose Your Path**

### **I want to see the AI agents in action:**
â†’ Read [Demo & Presentation Guide](03-Demo-Presentation.md) and run `python demo/enhanced_database_monitor.py`

### **I want to deploy this system:**
â†’ Read [Deployment & Operations Guide](04-Deployment-Operations.md) and follow the quick start steps

### **I want to understand how it works:**
â†’ Read [Architecture Overview](01-Architecture-Overview.md) for the big picture

### **I want to monitor and maintain the system:**
â†’ Read [Monitoring & Observability Guide](02-Monitoring-Observability.md) for operational guidance

### **I want to modify or extend the agents:**
â†’ Read [Technical Implementation Guide](05-Technical-Implementation.md) for development details

### **âœ… What We Have: Complete NFRGuard System**
- 7 AI Agents protecting Bank of Anthos
- Real-time fraud detection working during actual transactions
- Live compliance monitoring active
- Privacy protection monitoring logs
- Customer sentiment analysis ready
- **RAG-Enhanced Decisions** - Agents access real Australian banking regulations
- **Regulatory Transparency** - Every decision backed by actual regulatory guidance
- URL: http://34.40.211.236
- Status: Running on GKE in Australia
- Agents react to real transactions in real-time
- Automated compliance checking
- Proactive customer service
- Multi-agent coordination via events
- Business impact clearly demonstrated

### **Why NFRGuard Matters to Your Business**

#### **Before NFRGuard:**
- âŒ Manual fraud detection (slow, expensive, error-prone)
- âŒ Human compliance reviews (time-consuming, inconsistent)  
- âŒ Reactive customer service (problems discovered too late)
- âŒ High operational costs (many people needed for security)

#### **After NFRGuard:**
- âœ… **Automatic fraud detection** (instant, 24/7, consistent)
- âœ… **Automated compliance** (follows rules perfectly, every time)
- âœ… **Proactive customer service** (spots issues before customers complain)
- âœ… **Lower operational costs** (fewer people needed, better results)

### **Business Benefits in Numbers**

| Benefit | Impact | Example |
|---------|--------|---------|
| **Fraud Prevention** | Saves millions in potential losses | Blocks $50K fraudulent transfer instantly |
| **Compliance** | Avoids regulatory fines ($100K+ per violation) | Automatically reports suspicious transactions |
| **Customer Service** | Reduces call center costs by 30-50% | AI handles 80% of routine inquiries |
| **Manual Reviews** | Cuts human review time by 80% | 1000 transactions reviewed in seconds |
| **Operational Efficiency** | 24/7 availability, never gets tired | Processes transactions while humans sleep |

## ğŸ‘¥ **Meet Your AI Security Team**

### ğŸ•µï¸ **Transaction Risk Agent - "The Fraud Detective"**
**What it does:** Like having a detective who examines every transaction in real-time
- **Watches every transaction** as it happens
- **Spots suspicious patterns** (like someone suddenly spending $50,000 at 3 AM)
- **Flags risky transactions** before they cause problems
- **Example:** "This customer usually spends $100/month, but just tried to transfer $25,000 to a foreign account - that's suspicious!"

**Business Value:** Prevents fraud losses, protects customer accounts, maintains trust

### ğŸ“‹ **Compliance Agent - "The Rules Expert"**
**What it does:** Like having a compliance officer who knows every banking regulation
- **Checks every flagged transaction** against banking rules (like AUSTRAC in Australia)
- **Decides what action to take** (monitor, hold, or block)
- **Ensures you follow the law** automatically
- **Example:** "This $15,000 transfer needs to be reported to AUSTRAC and held for review"

**Business Value:** Avoids regulatory fines, ensures legal compliance, protects bank's reputation

### ğŸ›¡ï¸ **Resilience Agent - "The Action Taker"**
**What it does:** Like having a security guard who takes immediate action
- **Executes the decisions** made by the Compliance Agent
- **Puts holds on suspicious transactions** to prevent money from leaving
- **Blocks accounts** when necessary
- **Example:** "Transaction blocked - customer account frozen pending investigation"

**Business Value:** Prevents financial losses, stops fraud in progress, protects bank assets

### ğŸ˜Š **Customer Sentiment Agent - "The Mood Reader"**
**What it does:** Like having a customer service manager who reads between the lines
- **Analyzes customer messages** and feedback
- **Detects when customers are frustrated** or angry
- **Flags trending issues** before they become big problems
- **Example:** "50 customers mentioned 'slow transfers' this week - we might have a system issue"

**Business Value:** Improves customer satisfaction, prevents complaints, identifies service issues early

### ğŸ“š **Knowledge Agent - "The Translator"**
**What it does:** Like having a communications expert who explains complex things simply
- **Takes technical alerts** and turns them into plain English
- **Creates human-readable reports** for managers
- **Explains what happened** in simple terms
- **Example:** "Transaction blocked because customer tried to send money to a high-risk country during unusual hours"

**Business Value:** Better decision-making, clearer communication, faster problem resolution

### ğŸª **Banking Assistant Agent - "The Customer Service Rep"**
**What it does:** Like having a helpful bank teller available 24/7
- **Answers customer questions** about balances and transactions
- **Processes routine banking requests** automatically
- **Provides account information** instantly
- **Example:** "Your balance is $1,250.50. Here are your last 5 transactions..."

**Business Value:** Reduces call center costs, improves customer experience, available 24/7

### ğŸ”’ **Data Privacy Agent - "The Privacy Guardian"**
**What it does:** Like having a privacy officer who monitors all data handling
- **Scans logs and requests** for personal information leaks
- **Detects PII violations** (emails, phone numbers, SSNs)
- **Flags privacy breaches** before they become problems
- **Example:** "Email address detected in log entry - potential privacy violation"

**Business Value:** Protects customer privacy, ensures GDPR compliance, prevents data breaches

## ğŸ”„ **How They Work Together: A Real Example**

Let's say a customer tries to transfer $20,000 to a foreign account at 2 AM:

1. **ğŸª Banking Assistant** receives the transaction request
2. **ğŸ•µï¸ Transaction Risk Agent** spots this as suspicious (unusual amount + time)
3. **ğŸ“‹ Compliance Agent** checks the rules and says "This needs to be held and reported"
4. **ğŸ›¡ï¸ Resilience Agent** immediately blocks the transaction
5. **ğŸ“š Knowledge Agent** creates a report: "Blocked $20K transfer - suspicious timing and amount"
6. **ğŸ˜Š Customer Sentiment Agent** monitors if the customer complains about the delay

**Result:** Fraud prevented, regulations followed, customer informed, bank protected.

## ğŸ“Š **Agent Message Flow & Order**

### **Complete Communication Sequence:**

```
Client Request â†’ Banking Assistant â†’ Transaction Risk Agent â†’ Compliance Agent â†’ Resilience Agent
                     â†“                        â†“                      â†“                    â†“
                Knowledge Agent â† Knowledge Agent â† Knowledge Agent â† Knowledge Agent
                     â†“
                Client Response

Customer Message â†’ Customer Sentiment Agent â†’ Knowledge Agent â†’ Client Response

Log Entry â†’ Data Privacy Agent â†’ Knowledge Agent â†’ Client Response
```

### **Message Types & When They're Sent:**

| Step | From Agent | To Agent | Message | When | Purpose |
|------|------------|----------|---------|------|---------|
| 1 | Client | Banking Assistant | HTTP Request | Transaction starts | Initiate transaction |
| 2 | Banking Assistant | Event Bus | `transaction.created` | Always | Notify system |
| 3 | Event Bus | Risk Agent | Event | Always | Trigger risk analysis |
| 4 | Risk Agent | Event Bus | `risk.flagged` | If suspicious | Alert compliance |
| 5 | Event Bus | Compliance Agent | Event | If risk flagged | Check regulations |
| 6 | Compliance Agent | Event Bus | `compliance.action` | If action needed | Execute action |
| 7 | Event Bus | Resilience Agent | Event | If action needed | Block/hold transaction |
| 8 | Event Bus | Knowledge Agent | All events | Always | Create human alerts |
| 9 | Client | Sentiment Agent | HTTP Request | Customer message | Analyze sentiment |
| 10 | Sentiment Agent | Event Bus | `ops.alert` | If negative | Alert operations |
| 11 | Event Bus | Knowledge Agent | Event | If negative | Create sentiment alert |
| 12 | System | Data Privacy Agent | Log Entry | Always | Check for PII violations |
| 13 | Data Privacy Agent | Event Bus | `privacy.violation` | If PII detected | Alert privacy breach |
| 14 | Event Bus | Knowledge Agent | Event | If privacy violation | Create privacy alert |

### **Visual Flow Chart:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚â”€â”€â”€â–¶â”‚  Banking        â”‚â”€â”€â”€â–¶â”‚  Transaction    â”‚
â”‚  Request    â”‚    â”‚  Assistant      â”‚    â”‚  Risk Agent     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                        â”‚
                           â–¼                        â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Knowledge      â”‚â—€â”€â”€â”€â”‚  Compliance     â”‚
                   â”‚  Agent          â”‚    â”‚  Agent          â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                        â”‚
                           â–¼                        â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Client         â”‚â—€â”€â”€â”€â”‚  Resilience     â”‚
                   â”‚  Response       â”‚    â”‚  Agent          â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer   â”‚â”€â”€â”€â–¶â”‚  Customer       â”‚â”€â”€â”€â–¶â”‚  Knowledge      â”‚
â”‚  Message    â”‚    â”‚  Sentiment      â”‚    â”‚  Agent          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  Agent          â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
                                                   â–¼
                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                           â”‚  Client         â”‚
                                           â”‚  Response       â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Log Entry  â”‚â”€â”€â”€â–¶â”‚  Data Privacy   â”‚â”€â”€â”€â–¶â”‚  Knowledge      â”‚
â”‚             â”‚    â”‚  Agent          â”‚    â”‚  Agent          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â–¼
                                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                           â”‚  Client         â”‚
                                           â”‚  Response       â”‚
                                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Key Message Flow Patterns:**

1. **Linear Flow**: Banking â†’ Risk â†’ Compliance â†’ Resilience
2. **Parallel Flow**: Multiple agents subscribe to same events
3. **Independent Flow**: Sentiment Agent and Data Privacy Agent work separately
4. **Response Flow**: Knowledge Agent provides human-readable alerts
5. **Privacy Flow**: Log Entry â†’ Data Privacy Agent â†’ Knowledge Agent
6. **Sentiment Flow**: Customer Message â†’ Sentiment Agent â†’ Knowledge Agent

## ğŸ¯ **The Bottom Line**

**NFRGuard is like having a team of expert security professionals working around the clock, but:**
- **Faster** than humans (decisions in milliseconds)
- **More consistent** than humans (never gets tired or makes mistakes)
- **Always available** (works 24/7, 365 days a year)
- **Costs less** than hiring equivalent human staff
- **Gets smarter** over time (learns from every transaction)

**It's not replacing your security team - it's making them superhuman!** ğŸ¦¸â€â™‚ï¸

Your bank becomes more secure, more compliant, and more profitable, while your customers get better service and faster responses. It's a win-win-win situation! ğŸ‰

## ğŸ—ï¸ Architecture Overview

The agents are designed as independent microservices that integrate with the existing Bank of Anthos services using a **hybrid communication approach**:

### **Communication Patterns**
1. **Event-Driven Architecture** - Pub/Sub pattern for cross-cutting concerns
2. **Direct Service Integration** - Synchronous HTTP calls for immediate operations  
3. **Shared Component Architecture** - Common utilities and clients

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Banking       â”‚    â”‚   Transaction    â”‚    â”‚   Customer      â”‚
â”‚   Assistant     â”‚    â”‚   Risk Agent     â”‚    â”‚   Sentiment     â”‚
â”‚   Agent         â”‚    â”‚                 â”‚    â”‚   Agent         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Event Bus     â”‚
                    â”‚   (Pub/Sub)     â”‚
                    â”‚   Messaging     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Compliance     â”‚    â”‚   Resilience     â”‚    â”‚   Knowledge     â”‚
â”‚   Agent         â”‚    â”‚   Agent          â”‚    â”‚   Agent         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Balance        â”‚    â”‚   Transaction   â”‚    â”‚   Ledger        â”‚
â”‚   Reader         â”‚    â”‚   History      â”‚    â”‚   Writer        â”‚
â”‚   Service        â”‚    â”‚   Service      â”‚    â”‚   Service       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Agent Communication & Event Handling

### **Enhanced Messaging System**

Our messaging system (`shared/messaging.py`) provides:

- **Publish/Subscribe Pattern** - Decoupled agent communication
- **Thread-Safe Operations** - Concurrent event handling
- **Error Resilience** - Graceful error handling in event processing
- **External Broker Support** - Integration with Google Cloud Pub/Sub, NATS, etc.

### **Event Topics & Flow**

```python
# Event Topics Used:
"transaction.created"    # New transaction events
"risk.flagged"          # Suspicious transaction alerts  
"compliance.action"     # Regulatory compliance actions
"ops.alert"            # Operational alerts from sentiment
"privacy.violation"    # Data privacy violations
```

### **Automated Event Flow**

```
Transaction Created â†’ Risk Agent â†’ Compliance Agent â†’ Resilience Agent
        â†“                â†“              â†“                â†“
Customer Message â†’ Sentiment Agent â†’ Ops Alert â†’ Knowledge Agent
```

**Example Event Flow:**
1. **Transaction Created** â†’ Risk Agent detects anomaly
2. **Risk Flagged** â†’ Compliance Agent applies regulatory checks  
3. **Compliance Action** â†’ Resilience Agent executes holds/blocks
4. **All Events** â†’ Knowledge Agent creates human-readable alerts

### **Message Format**

```json
{
    "event_type": "risk.flagged",
    "transaction_id": "txn_12345",
    "score": 0.95,
    "reason": "high_amount_or_cross_border",
    "detected_by": "transaction_risk_agent_v1",
    "timestamp": "2025-01-14T10:30:00Z"
}
```

## ğŸ¤– Available Agents

### 1. **Transaction Risk Agent** (`transaction_risk_agent/`)
- **Purpose**: Real-time fraud detection and risk scoring
- **Capabilities**: Anomaly detection, risk scoring, event publishing
- **Events**: Publishes `risk.flagged` events
- **Tools**: `on_transaction_event`, `check_transaction_anomaly`

### 2. **Compliance Agent** (`compliance_agent/`)
- **Purpose**: Regulatory compliance and AUSTRAC checks
- **Capabilities**: Compliance validation, action determination
- **Events**: Subscribes to `risk.flagged`, publishes `compliance.action`
- **Tools**: `compliance_check`, `handle_risk_event`

### 3. **Resilience Agent** (`resilience_agent/`)
- **Purpose**: Operational actions and transaction holds
- **Capabilities**: Transaction blocking, hold management
- **Events**: Subscribes to `compliance.action`
- **Tools**: `apply_hold`, `handle_compliance_action`

### 4. **Customer Sentiment Agent** (`customer_sentiment_agent/`)
- **Purpose**: Customer message sentiment analysis
- **Capabilities**: Sentiment scoring, trending issue detection
- **Events**: Publishes `ops.alert` events
- **Tools**: `analyze_sentiment`

### 5. **Knowledge Agent** (`knowledge_agent/`)
- **Purpose**: Human-readable alert generation
- **Capabilities**: Event explanation, alert formatting
- **Events**: Subscribes to `risk.flagged`, `compliance.action`, `ops.alert`
- **Tools**: `explain_event`, `handle_risk_event`, `handle_compliance_event`, `handle_ops_alert`

### 6. **Banking Assistant** (`banking_assistant_agent/`)
- **Purpose**: Primary banking operations and customer assistance
- **Capabilities**: Balance checking, transaction history, account management
- **Integration**: Direct API calls to Bank of Anthos services
- **Tools**: `check_balance`, `get_transaction_history`, `process_transaction`

### 7. **Data Privacy Agent** (`data_privacy_agent/`)
- **Purpose**: PII violation detection and privacy monitoring
- **Capabilities**: Log scanning, PII detection, privacy breach alerts
- **Events**: Publishes `privacy.violation` events
- **Tools**: `check_privacy_violation`

## ğŸ› ï¸ Enhanced Messaging API

### **Core Functions**

```python
from shared.messaging import publish, subscribe, unsubscribe, list_topics

# Publishing events
publish("risk.flagged", {
    "event_type": "risk.flagged",
    "transaction_id": "txn_123",
    "score": 0.95
})

# Subscribing to events
def handle_risk_event(event):
    print(f"Risk detected: {event}")

subscribe("risk.flagged", handle_risk_event)

# Unsubscribing
unsubscribe("risk.flagged", handle_risk_event)

# Utility functions
topics = list_topics()  # List all active topics
```

### **Thread Safety & Error Handling**

- **Thread-Safe**: Uses locks for concurrent access
- **Error Resilience**: Failed handlers don't crash the system
- **External Integration**: Supports HTTP webhooks and message brokers

## ğŸ§ª Testing & Validation

### **Comprehensive Test Suite**

Run the complete messaging test suite:

```bash
cd bank-of-anthos/src/agents
python test_messaging.py
```

**Test Coverage:**
- âœ… Basic publish/subscribe functionality
- âœ… Multiple subscribers on same topic
- âœ… Unsubscribe functionality
- âœ… Complete agent communication flow
- âœ… Error handling and resilience
- âœ… Topic listing and management

### **Manual Testing**

```bash
# Test individual agents
cd transaction_risk_agent
python agent.py

cd compliance_agent  
python agent.py

# Test messaging system
python test_messaging.py
```

## ğŸš€ Deployment & Configuration

### **Environment Variables**

```bash
# Messaging Configuration
LOCAL_BROKER_URL=http://localhost:8080  # Optional external broker
ANOMALY_THRESHOLD=0.8                  # Risk detection threshold
AUSTRAC_THRESHOLD=10000                # Compliance threshold
ANTHOS_API_BASE=http://localhost:8080  # Bank of Anthos API base
```

### **Kubernetes Deployment**

```bash
# Deploy all agents
kubectl apply -f */k8s/

# Deploy specific agent
kubectl apply -f transaction_risk_agent/k8s/
kubectl apply -f compliance_agent/k8s/
```

## ğŸ”§ Development Guidelines

### **Adding New Agents**

1. **Create Agent Directory**: Follow existing structure
2. **Implement Event Handlers**: Use `subscribe()` for event listening
3. **Add Event Publishing**: Use `publish()` for event emission
4. **Add Tests**: Include messaging tests in test suite
5. **Update Documentation**: Document event topics and handlers

### **Event Design Patterns**

```python
# Good Event Structure
{
    "event_type": "domain.action",      # Clear event type
    "transaction_id": "txn_123",       # Unique identifier
    "timestamp": "2025-01-14T10:30:00Z", # ISO timestamp
    "detected_by": "agent_name_v1",     # Source agent
    "metadata": {...}                   # Additional context
}

# Event Handler Pattern
def handle_event(event: dict) -> dict:
    """Handle specific event type"""
    print(f"[AGENT] Processing: {event}")
    # Process event logic
    return {"status": "processed"}
```

## ğŸ”„ Integration with Bank of Anthos

The agents integrate seamlessly with existing Bank of Anthos services:

- **Balance Reader** â†’ Banking Assistant (direct API calls)
- **Transaction History** â†’ Banking Assistant (direct API calls)  
- **Ledger Writer** â†’ Banking Assistant (direct API calls)
- **User Service** â†’ All agents (authentication)
- **Accounts DB** â†’ All agents (account data)
- **Ledger DB** â†’ All agents (transaction data)

## ğŸ¯ Key Benefits

### **Scalability**
- **Independent Deployment** - Each agent can be scaled separately
- **Horizontal Scaling** - Multiple instances of same agent
- **Load Distribution** - Event-driven load balancing

### **Resilience** 
- **Fault Isolation** - Agent failures don't cascade
- **Retry Mechanisms** - Built-in error handling
- **Circuit Breakers** - Prevent cascade failures

### **Maintainability**
- **Loose Coupling** - Agents communicate via events
- **Clear Interfaces** - Well-defined event contracts
- **Easy Testing** - Isolated unit and integration tests

## ğŸ“š Additional Resources

- **Google ADK Documentation**: https://google.github.io/adk-docs/
- **ADK Samples**: https://github.com/google/adk-samples
- **Bank of Anthos**: https://github.com/GoogleCloudPlatform/bank-of-anthos
- **Event-Driven Architecture Patterns**: https://microservices.io/patterns/data/event-driven-architecture.html

---

## ğŸš€ Quick Start

```bash
# 1. Set up environment
cd bank-of-anthos/src/agents
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# 2. Install dependencies
pip install google-adk
pip install -r requirements.txt

# 3. Run tests
python test_messaging.py

# 4. Start real frontend integration (RECOMMENDED)
python real_frontend_integration.py

# 5. Alternative: Start individual agents
python transaction_risk_agent/agent.py &
python compliance_agent/agent.py &
python resilience_agent/agent.py &

# 6. Test event flow
python -c "
from shared.messaging import publish
publish('transaction.created', {'transaction_id': 'txn_test', 'amount': 15000})
"
```

### ğŸ¬ **Live Demo with Bank of Anthos Frontend**

**Real-time agent monitoring of Bank of Anthos transactions:**

```bash
# Start real frontend integration
python real_frontend_integration.py

# Then make transactions on: http://34.40.211.236
# Watch agents react in real-time!
```

**See agents protect your bank in real-time!** ğŸ›¡ï¸

**NFRGuard** provides enterprise-grade AI agent protection for banking operations with automated risk detection, compliance monitoring, and operational resilience! ğŸ›¡ï¸

## Directory Structure

```
agents/
â”œâ”€â”€ banking_assistant_agent/   # Banking operations agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py              # Main agent implementation
â”‚   â”œâ”€â”€ .env                  # Environment configuration
â”‚   â”œâ”€â”€ tools/                # Agent-specific tools
â”‚   â”œâ”€â”€ config.yaml           # Agent configuration
â”‚   â”œâ”€â”€ tests/                # Test suite
â”‚   â”œâ”€â”€ README.md             # Agent documentation
â”‚   â”œâ”€â”€ Dockerfile            # Container definition
â”‚   â”œâ”€â”€ skaffold.yaml         # Development deployment
â”‚   â””â”€â”€ k8s/                  # Kubernetes manifests
â”œâ”€â”€ transaction_risk_agent/   # Fraud detection agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ compliance_agent/         # Compliance monitoring agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ resilience_agent/         # Operational actions agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ customer_sentiment_agent/ # Customer sentiment analysis agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ knowledge_agent/          # Human-readable alerts agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ data_privacy_agent/       # Privacy monitoring agent
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ agent.py
â”‚   â”œâ”€â”€ tools/
â”‚   â”œâ”€â”€ tests/
â”‚   â””â”€â”€ k8s/
â”œâ”€â”€ shared/                   # Shared components
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ messaging.py          # Event messaging system
â”œâ”€â”€ test_agent/               # Test agent for development
â”œâ”€â”€ test_messaging.py         # Messaging system tests
â”œâ”€â”€ mcp_integration_example.py # Future MCP integration example (not implemented)
â”œâ”€â”€ MCP_INTEGRATION_PLAN.md   # Future MCP integration plan (not implemented)
â”œâ”€â”€ AGENT_COMMUNICATION_FLOW.md # Communication flow diagrams
â”œâ”€â”€ AGENT_MESSAGE_FLOW.md     # Message flow documentation
â””â”€â”€ README.md                 # This file
```

## âœ… Contest Compliance Checklist

- **Platform**: Targets GKE; Kubernetes manifests included under `src/agents/k8s/`
- **Google AI Models**: Uses Gemini 2.5 Flash via ADK-configured agents
- **ADK**: Adopted for agent structure and tooling
- **MCP**: Not implemented; Pub/Sub chosen for agent communication
- **A2A**: Not used by design; Pub/Sub provides better scalability and decoupling
- **New Work**: All agent code under `src/agents` created during contest period
- **Testing Access**: Provide public demo URL or test build + creds (see below)
- **Third-Party Terms**: Noted below; ensure licenses and usage comply

## ğŸ“„ Third-Party Notices

- **Google ADK** â€” Licensed per Google terms
- **Google AI (Gemini 2.5 Flash)** â€” Subject to Google AI usage terms
- **Optional brokers** (e.g., Google Cloud Pub/Sub, NATS, Redis) â€” Use under their licenses
- Ensure environment usage complies with each providerâ€™s T&Cs and your org policies.

## ğŸ§° kubectl-ai and Gemini CLI (Optional)

- **kubectl-ai**: Use to generate manifests or scale deployments via natural language
  - Example: "scale deployment transaction-risk-agent to 3 in namespace nfrguard-agents"
- **Gemini CLI**: Summarize logs or generate runbooks from repo context
  - Example: `gemini ask "Summarize agent topics in src/agents/shared/messaging.py"`

## â˜ï¸ GKE Deployment Guide

1. Build and push images (replace `PROJECT_ID`):
   ```bash
   gcloud builds submit --tag gcr.io/PROJECT_ID/transaction-risk-agent src/agents/transaction_risk_agent
   gcloud builds submit --tag gcr.io/PROJECT_ID/compliance-agent src/agents/compliance_agent
   gcloud builds submit --tag gcr.io/PROJECT_ID/resilience-agent src/agents/resilience_agent
   gcloud builds submit --tag gcr.io/PROJECT_ID/knowledge-agent src/agents/knowledge_agent
   gcloud builds submit --tag gcr.io/PROJECT_ID/customer-sentiment-agent src/agents/customer_sentiment_agent
   gcloud builds submit --tag gcr.io/PROJECT_ID/data-privacy-agent src/agents/data_privacy_agent
   gcloud builds submit --tag gcr.io/PROJECT_ID/banking-assistant src/agents/banking_assistant_agent
   # Future MCP server (not implemented)
   # gcloud builds submit --tag gcr.io/PROJECT_ID/mcp-server mcp-servers/minimal
   ```
2. Create cluster and deploy:
   ```bash
   gcloud container clusters create nfrguard --region=us-central1 --num-nodes=2
   kubectl apply -f src/agents/k8s/agents.yaml
   # kubectl apply -f src/agents/k8s/mcp-server.yaml   # future MCP server (not implemented)
   ```
3. (Optional) Expose public demo via Ingress (edit `agents.yaml` Ingress block and set DNS)
4. Get service endpoints:
   ```bash
   kubectl -n nfrguard-agents get svc
   ```
5. Configure env for external broker if used:
   - Set `PUBSUB_BROKER_URL` in `nfrguard-agents-config` ConfigMap

## ğŸ¬ Demo Video Guidance

- Storyboard: Transaction flow (Riskâ†’Complianceâ†’Resilience), Sentiment and Privacy flows, Knowledge alerts
- Show logs from `shared/messaging.py` (publish/subscribe), then UI/API response
- Close with architecture and "Why Pub/Sub for Agent Communication" slide



